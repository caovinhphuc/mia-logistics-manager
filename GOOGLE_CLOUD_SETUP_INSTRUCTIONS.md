# üîß Google Cloud Platform Setup Instructions

## ‚úÖ ƒê√£ ho√†n th√†nh

1. ‚úÖ gcloud CLI ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t (version 544.0.0)
2. ‚úÖ PATH ƒë√£ ƒë∆∞·ª£c c·∫•u h√¨nh

---

## üìã B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p v√†o Google Cloud

Ch·∫°y l·ªánh sau trong terminal:

```bash
export PATH=/opt/homebrew/share/google-cloud-sdk/bin:"$PATH"
gcloud auth login
```

ƒêi·ªÅu n√†y s·∫Ω:
- M·ªü tr√¨nh duy·ªát
- Y√™u c·∫ßu ƒëƒÉng nh·∫≠p t√†i kho·∫£n Google
- Y√™u c·∫ßu c·∫•p quy·ªÅn cho Google Cloud CLI

---

## üìã B∆∞·ªõc 2: T·∫°o Google Cloud Project

Sau khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng, ch·∫°y:

```bash
# T·∫°o project m·ªõi
gcloud projects create mia-logistics-prod --name="MIA Logistics Production"

# Set project l√†m default
gcloud config set project mia-logistics-prod
```

**L∆∞u √Ω**: N·∫øu t√™n project ƒë√£ t·ªìn t·∫°i, h√£y ch·ªçn t√™n kh√°c.

---

## üìã B∆∞·ªõc 3: Enable Billing

1. Truy c·∫≠p: https://console.cloud.google.com/billing
2. Click "Link a billing account"
3. Ch·ªçn billing account c·ªßa b·∫°n
4. Link v·ªõi project `mia-logistics-prod`

**QUAN TR·ªåNG**: C·∫ßn c√≥ billing account ƒë·ªÉ s·ª≠ d·ª•ng c√°c API.

---

## üìã B∆∞·ªõc 4: Enable APIs

Ch·∫°y c√°c l·ªánh sau ƒë·ªÉ enable t·∫•t c·∫£ APIs c·∫ßn thi·∫øt:

```bash
export PATH=/opt/homebrew/share/google-cloud-sdk/bin:"$PATH"

# Enable APIs
gcloud services enable sheets.googleapis.com
gcloud services enable drive.googleapis.com
gcloud services enable script.googleapis.com
gcloud services enable maps-backend.googleapis.com
gcloud services enable places-backend.googleapis.com
gcloud services enable directions-backend.googleapis.com
gcloud services enable distance-matrix-backend.googleapis.com
gcloud services enable geocoding-backend.googleapis.com
gcloud services enable geolocation.googleapis.com

# Verify APIs are enabled
gcloud services list --enabled
```

---

## üìã B∆∞·ªõc 5: T·∫°o Service Account

```bash
# Create service account
gcloud iam service-accounts create mia-logistics-service \
  --display-name="MIA Logistics Service Account" \
  --description="Service account for MIA Logistics Manager"

# Get service account email
SA_EMAIL=$(gcloud iam service-accounts list \
  --filter="displayName:MIA Logistics Service Account" \
  --format="value(email)")

echo "Service Account Email: $SA_EMAIL"

# Grant roles
gcloud projects add-iam-policy-binding mia-logistics-prod \
  --member="serviceAccount:$SA_EMAIL" \
  --role="roles/sheets.editor"

gcloud projects add-iam-policy-binding mia-logistics-prod \
  --member="serviceAccount:$SA_EMAIL" \
  --role="roles/drive.file"

gcloud projects add-iam-policy-binding mia-logistics-prod \
  --member="serviceAccount:$SA_EMAIL" \
  --role="roles/script.developer"

# Create v√† download key
mkdir -p credentials
gcloud iam service-accounts keys create credentials/service-account-key.json \
  --iam-account=$SA_EMAIL

echo "‚úÖ Service account key saved to: credentials/service-account-key.json"
```

---

## üìã B∆∞·ªõc 6: Setup OAuth 2.0 (Console UI)

Kh√¥ng th·ªÉ l√†m qua CLI, c·∫ßn l√†m qua Console:

1. Truy c·∫≠p: https://console.cloud.google.com/apis/credentials
2. Click "Create Credentials" > "OAuth 2.0 Client ID"
3. N·∫øu ch∆∞a c√≥ OAuth consent screen, t·∫°o:
   - User Type: External (ho·∫∑c Internal n·∫øu d√πng Workspace)
   - App name: MIA Logistics Manager
   - Support email: your-email@example.com
4. Back l·∫°i Credentials, click "Create Credentials" > "OAuth 2.0 Client ID"
5. Application type: **Web application**
6. Name: MIA Logistics OAuth Client
7. Authorized origins:
   - `http://localhost:3000`
   - `https://yourdomain.com` (production)
8. Authorized redirect URIs:
   - `http://localhost:3000/auth/google/callback`
   - `https://yourdomain.com/auth/google/callback`
9. Click "Create"
10. **L∆∞u l·∫°i Client ID v√† Client Secret**

---

## üìã B∆∞·ªõc 7: T·∫°o API Key cho Maps

### Option 1: Qua Console UI (Easier)

1. Truy c·∫≠p: https://console.cloud.google.com/apis/credentials
2. Click "Create Credentials" > "API Key"
3. Copy API key
4. Click "Restrict Key"
5. Application restrictions: HTTP referrers
   - Add: `http://localhost:3000/*`
   - Add: `https://yourdomain.com/*`
6. API restrictions:
   - Select: Maps JavaScript API, Places API, Directions API, etc.
7. Save

### Option 2: Qua CLI

```bash
# Create API key
gcloud alpha services api-keys create \
  --display-name="MIA Logistics Maps API Key"

# Get the key
API_KEY=$(gcloud alpha services api-keys list \
  --filter="displayName:MIA Logistics Maps API Key" \
  --format="value(name)")

# Restrict key
gcloud alpha services api-keys update $API_KEY \
  --api-target=maps-backend.googleapis.com \
  --api-target=places-backend.googleapis.com \
  --api-target=directions-backend.googleapis.com
```

---

## üìã B∆∞·ªõc 8: T·∫°o Google Sheets Database

1. Truy c·∫≠p: https://sheets.google.com
2. T·∫°o spreadsheet m·ªõi: "MIA Logistics Database"
3. Copy Spreadsheet ID t·ª´ URL:
   ```
   https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit
   ```
4. Share v·ªõi Service Account:
   - Click "Share" button
   - Add email t·ª´ Step 5 (SA_EMAIL)
   - Set permission: "Editor"
   - Click "Share"

---

## üìã B∆∞·ªõc 9: T·∫°o Google Drive Folders

1. Truy c·∫≠p: https://drive.google.com
2. T·∫°o folder: "MIA Logistics Files"
3. Create subfolders:
   - Transport Documents
   - Warehouse Images
   - Staff Documents
   - Partner Contracts
   - System Backups
4. Share main folder v·ªõi Service Account (t·ª´ Step 5)
5. Copy Folder ID t·ª´ URL:
   ```
   https://drive.google.com/drive/folders/FOLDER_ID
   ```

---

## üìã B∆∞·ªõc 10: Update Environment Variables

T·∫°o ho·∫∑c update file `.env`:

```bash
# Copy template
cp .env.example .env

# Edit file v·ªõi th√¥ng tin t·ª´ c√°c b∆∞·ªõc tr√™n
nano .env
```

Fill in:

```bash
# Google Cloud
REACT_APP_GOOGLE_CLIENT_ID=your_client_id_from_step_6
REACT_APP_GOOGLE_API_KEY=your_api_key_from_step_7

# Google Sheets
REACT_APP_GOOGLE_SPREADSHEET_ID=your_spreadsheet_id_from_step_8

# Google Drive
REACT_APP_GOOGLE_DRIVE_FOLDER_ID=your_folder_id_from_step_9

# Service Account
GOOGLE_SERVICE_ACCOUNT_KEY=./credentials/service-account-key.json
```

---

## ‚úÖ Checklist

- [ ] B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p gcloud
- [ ] B∆∞·ªõc 2: T·∫°o project
- [ ] B∆∞·ªõc 3: Enable billing
- [ ] B∆∞·ªõc 4: Enable APIs
- [ ] B∆∞·ªõc 5: T·∫°o Service Account
- [ ] B∆∞·ªõc 6: Setup OAuth 2.0
- [ ] B∆∞·ªõc 7: T·∫°o API Key
- [ ] B∆∞·ªõc 8: T·∫°o Google Sheets
- [ ] B∆∞·ªõc 9: T·∫°o Google Drive folders
- [ ] B∆∞·ªõc 10: Update .env file

---

## üéâ Ho√†n th√†nh!

Sau khi ho√†n th√†nh t·∫•t c·∫£ c√°c b∆∞·ªõc, build l·∫°i project:

```bash
npm run build
```

V√† deploy theo h∆∞·ªõng d·∫´n trong `DEPLOYMENT_SUMMARY.md`.

---

## üìû Help

N·∫øu g·∫∑p v·∫•n ƒë·ªÅ:
1. Check logs: `gcloud logs read`
2. Verify APIs: `gcloud services list`
3. Test authentication: `gcloud auth list`
4. Review docs: `docs/GOOGLE_CLOUD_SETUP.md`
